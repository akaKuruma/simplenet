#!/usr/bin/python

import os
import baker
import requests
import ConfigParser

config_file = ('/etc/simplenet/simplenet.cfg' if not 'SIMPLENET_CFG'
                in os.environ else os.environ['SIMPLENET_CFG'])

config = ConfigParser.ConfigParser()
config.read(config_file)

server = 'http://127.0.0.1:8081'
network_appliance = 'firewall'

@baker.command(
    params={ "action": "Valid actions <list all|create|delete|rename>",
             "name": "Your neighborhood name"}
)
def neighborhood(action, name):
    base_url = '%s/%s/neighborhoods' % (server, network_appliance)
    action_list = { 'list':  base_url,
                    'create': base_url,
                    'delete': '%s/%s' % (base_url, name) }

    url = action_list[action]
    r = None
    if action == 'list':
        r = requests.get(url)
    elif action == 'create':
        r = requests.post(url, data={'name': name})
    elif action == 'delete':
        r = requests.delete(url)
    print r.json if hasattr(r, 'json') else r.text

baker.run()
